workflows:
  android-kivy-build:
    name: Build Kivy Android APK
    max_build_duration: 60
    environment:
      vars:
        ANDROID_HOME: /Users/builder/Library/Android/sdk
        JAVA_HOME: /Library/Java/JavaVirtualMachines/zulu-17.jdk/Contents/Home
      # pyenv global ayarı ile python 3.10 kullanılabilir
      scripts:
        - pyenv global 3.10.13
        - pip install --upgrade pip
        - pip install Cython==0.29.36
        - pip install buildozer==1.5.0
        - pip install virtualenv

    scripts:
      - echo "Yapı dizinine geçiliyor..."
      - cd $FCI_BUILD_DIR
      - echo "Gerekli Android SDK bileşenleri yükleniyor..."
      - yes | sdkmanager --licenses
      - sdkmanager "build-tools;36.0.0" "platforms;android-33" "ndk;25.1.8937393"
      - echo "Buildozer ile APK oluşturuluyor..."
      - buildozer android debug

    artifacts:
      - app/build/outputs/**/*.apk
      - build/**/outputs/**/*.apk
      - *.apk

    publishing:
      email:
        recipients:
          - moclabel01@gmail.com
        notify:
          success: true
          failure: true
